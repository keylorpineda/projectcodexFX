<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.chart.PieChart?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<VBox xmlns="http://javafx.com/javafx"
      xmlns:fx="http://javafx.com/fxml"
      fx:controller="com.municipal.reservationsfx.ui.controllers.ReportsAnalyticsController"
      spacing="24"
      styleClass="main-content"
      fillWidth="true">

    <padding>
        <Insets top="24" right="32" bottom="32" left="32"/>
    </padding>

    <HBox alignment="CENTER_LEFT" spacing="12">
        <VBox spacing="4" HBox.hgrow="ALWAYS">
            <Label text="Reportes globales" styleClass="page-title"/>
            <Label text="An치lisis estad칤stico del uso de instalaciones" styleClass="page-subtitle"/>
        </VBox>
        <HBox spacing="8">
            <Button fx:id="exportExcelButton" text="Exportar Excel" styleClass="primary-button">
                <graphic>
                    <Label text="游늵" styleClass="button-icon"/>
                </graphic>
            </Button>
            <Button fx:id="exportPdfButton" text="Exportar PDF" styleClass="primary-button">
                <graphic>
                    <Label text="游늯" styleClass="button-icon"/>
                </graphic>
            </Button>
        </HBox>
    </HBox>

    <VBox styleClass="card" spacing="18">
        <padding>
            <Insets top="24" right="24" bottom="24" left="24"/>
        </padding>

        <Label text="Rango de fechas" styleClass="card-title"/>
        <HBox spacing="16" alignment="CENTER_LEFT">
            <ChoiceBox fx:id="rangeFilter" prefWidth="180"/>
            <DatePicker fx:id="startDatePicker"/>
            <DatePicker fx:id="endDatePicker"/>
            <Region HBox.hgrow="ALWAYS"/>
            <Button fx:id="refreshButton" text="Actualizar" styleClass="pill-button"/>
        </HBox>
    </VBox>

    <HBox spacing="18">
        <VBox styleClass="metric-card" spacing="8" VBox.vgrow="ALWAYS">
            <padding>
                <Insets top="20" right="20" bottom="20" left="20"/>
            </padding>
            <Label text="Reservas Activas" styleClass="metric-label"/>
            <Label fx:id="activeReservationsLabel" text="0" styleClass="metric-value"/>
            <Label text="Eventos pr칩ximos dentro del rango" styleClass="metric-description" wrapText="true"/>
        </VBox>

        <VBox styleClass="metric-card" spacing="8" VBox.vgrow="ALWAYS">
            <padding>
                <Insets top="20" right="20" bottom="20" left="20"/>
            </padding>
            <Label text="Reservas Completadas" styleClass="metric-label"/>
            <Label fx:id="completedReservationsLabel" text="0" styleClass="metric-value"/>
            <Label text="Hist칩rico de eventos finalizados" styleClass="metric-description" wrapText="true"/>
        </VBox>

        <VBox styleClass="metric-card" spacing="8" VBox.vgrow="ALWAYS">
            <padding>
                <Insets top="20" right="20" bottom="20" left="20"/>
            </padding>
            <Label text="Tasa de asistencia" styleClass="metric-label"/>
            <Label fx:id="attendanceRateLabel" text="0%" styleClass="metric-value"/>
            <Label fx:id="attendanceTrendLabel" text="" styleClass="metric-trend"/>
        </VBox>

        <VBox styleClass="metric-card" spacing="8" VBox.vgrow="ALWAYS">
            <padding>
                <Insets top="20" right="20" bottom="20" left="20"/>
            </padding>
            <Label text="Incidencias" styleClass="metric-label"/>
            <Label fx:id="incidentsLabel" text="0" styleClass="metric-value"/>
            <Label text="Requieren seguimiento" styleClass="metric-description" wrapText="true"/>
        </VBox>
    </HBox>

    <HBox spacing="18">
        <VBox styleClass="card" spacing="18" VBox.vgrow="ALWAYS" prefWidth="360">
            <padding>
                <Insets top="24" right="24" bottom="24" left="24"/>
            </padding>
            <Label text="Distribuci칩n por tipo de espacio" styleClass="card-title"/>
            <PieChart fx:id="spaceDistributionChart" legendVisible="false" labelsVisible="true"/>
        </VBox>

        <VBox styleClass="card" spacing="18" VBox.vgrow="ALWAYS" HBox.hgrow="ALWAYS">
            <padding>
                <Insets top="24" right="24" bottom="24" left="24"/>
            </padding>
            <Label text="Espacios m치s utilizados" styleClass="card-title"/>
            <ListView fx:id="topSpacesList" VBox.vgrow="ALWAYS"/>
        </VBox>
    </HBox>

    <VBox styleClass="card" spacing="18">
        <padding>
            <Insets top="24" right="24" bottom="24" left="24"/>
        </padding>
        <Label text="Resumen mensual" styleClass="card-title"/>
        <TableView fx:id="monthlySummaryTable" fixedCellSize="48" columnResizePolicy="CONSTRAINED_RESIZE_POLICY">
            <columns>
                <TableColumn fx:id="monthColumn" text="Mes" prefWidth="160"/>
                <TableColumn fx:id="reservationsColumn" text="Reservas" prefWidth="120"/>
                <TableColumn fx:id="attendanceColumn" text="Asistencia" prefWidth="140"/>
                <TableColumn fx:id="growthColumn" text="Crecimiento" prefWidth="140"/>
            </columns>
        </TableView>
    </VBox>
</VBox>
